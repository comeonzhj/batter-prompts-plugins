(()=>{"use strict";var t,e,n;!function(t){t.DEEPSEEK="deepseek",t.KIMI="kimi",t.DOUBAO="doubao",t.UNKNOWN="unknown"}(t||(t={})),function(t){t.NORMAL="normal",t.LOADING="loading",t.SUCCESS="success",t.ERROR="error"}(e||(e={})),function(t){t.NETWORK_ERROR="network_error",t.API_ERROR="api_error",t.CONFIG_ERROR="config_error",t.UNKNOWN_ERROR="unknown_error"}(n||(n={})),Error;class i{static detectSite(){const e=window.location.hostname;return window.location.pathname,e.includes("deepseek.com")?t.DEEPSEEK:e.includes("moonshot.cn")||e.includes("kimi.com")?t.KIMI:e.includes("doubao.com")?t.DOUBAO:t.UNKNOWN}static getSiteConfig(t){const e=t||this.detectSite();return{...this.siteConfigs[e]}}static isSupportedSite(e){const n=e||this.detectSite();return n!==t.UNKNOWN&&this.siteConfigs[n].isEnabled}static waitForElement(t,e=1e4){return new Promise(n=>{const i=document.querySelector(t);if(i)return void n(i);const s=new MutationObserver(()=>{const e=document.querySelector(t);e&&(s.disconnect(),n(e))});s.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{s.disconnect(),n(null)},e)})}static async waitForElements(t,e=1e4){const n=t.map(t=>this.waitForElement(t,e));return Promise.all(n)}static isChatPage(){switch(this.detectSite()){case t.DEEPSEEK:return window.location.pathname.includes("/chat");case t.KIMI:return!0;case t.DOUBAO:return"/"===window.location.pathname||window.location.pathname.includes("/chat");default:return!1}}static getButtonStyleClasses(e){switch(e||this.detectSite()){case t.DEEPSEEK:return["ds-button","ds-button--primary","ds-button--filled","ds-button--rect","ds-button--m"];case t.KIMI:return["icon-button","attachment-button"];case t.DOUBAO:return["semi-button","semi-button-primary","samantha-button-Gqjh9l","tertiary-a_ZJsN","medium-MN8t8q"];default:return["pe-button"]}}static getEnhanceIcon(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n      <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>\n    </svg>'}static validateSiteConfig(e){return!(!e.inputSelector||!e.buttonContainerSelector||e.type===t.UNKNOWN)}static updateSiteConfig(t,e){this.siteConfigs[t]&&(this.siteConfigs[t]={...this.siteConfigs[t],...e})}static getAllSiteConfigs(){return{...this.siteConfigs}}static isElementVisible(t){if(!t)return!1;const e=window.getComputedStyle(t);return"none"!==e.display&&"hidden"!==e.visibility&&"0"!==e.opacity&&t.offsetWidth>0&&t.offsetHeight>0}static findButtonInsertPosition(e,n){const i=n||this.detectSite(),s=document.querySelector(e);if(!s)return null;switch(i){case t.DEEPSEEK:const e=s.querySelector(".ds-button");return(null==e?void 0:e.parentElement)||s;case t.KIMI:const n=s.querySelector(".attachment-button");return(null==n?void 0:n.parentElement)||s;case t.DOUBAO:const i=s.querySelector('[data-testid="deep_think_select_button"]');return(null==i?void 0:i.parentElement)||s;default:return s}}}i.siteConfigs={[t.DEEPSEEK]:{type:t.DEEPSEEK,name:"DeepSeek",inputSelector:"#chat-input",inputType:"textarea",buttonContainerSelector:".ec4f5d61",sendButtonSelector:".bcc55ca1",isEnabled:!0},[t.KIMI]:{type:t.KIMI,name:"Kimi",inputSelector:".chat-input-editor",inputType:"contenteditable",buttonContainerSelector:".left-area",sendButtonSelector:".send-button-container",isEnabled:!0},[t.DOUBAO]:{type:t.DOUBAO,name:"豆包",inputSelector:'[data-testid="chat_input_input"]',inputType:"textarea",buttonContainerSelector:".left-tools-wrapper-INTHKl",sendButtonSelector:'[data-testid="chat_input_send_button"]',isEnabled:!0},[t.UNKNOWN]:{type:t.UNKNOWN,name:"未知网站",inputSelector:"",inputType:"textarea",buttonContainerSelector:"",isEnabled:!1}};class s{constructor(t,e){this.element=t,this.inputType=e}getInputText(){switch(this.inputType){case"textarea":return this.element.value||"";case"contenteditable":return this.getContentEditableText();default:return""}}setInputText(t){switch(this.inputType){case"textarea":this.setTextareaValue(t);break;case"contenteditable":this.setContentEditableText(t)}this.triggerInput()}focus(){try{this.element.focus(),"contenteditable"===this.inputType&&this.setCursorToEnd()}catch(t){console.warn("聚焦失败:",t)}}triggerInput(){["input","change","keyup","blur"].forEach(t=>{try{const e=new Event(t,{bubbles:!0,cancelable:!0});this.element.dispatchEvent(e)}catch(e){try{const e=document.createEvent("Event");e.initEvent(t,!0,!0),this.element.dispatchEvent(e)}catch(e){console.warn(`触发 ${t} 事件失败:`,e)}}}),this.triggerFrameworkEvents()}getContentEditableText(){try{if(this.isKimiEditor()){const t=this.element.querySelectorAll("p"),e=[];t.forEach(t=>{t.querySelectorAll('span[data-lexical-text="true"]');const n=[];Array.from(t.childNodes).forEach(t=>{if(t.nodeType===Node.TEXT_NODE)n.push(t.textContent||"");else if(t.nodeType===Node.ELEMENT_NODE){const e=t;"SPAN"===e.tagName&&e.hasAttribute("data-lexical-text")?n.push(e.textContent||""):"BR"===e.tagName&&n.push("\n")}}),e.push(n.join(""))});const n=e.join("\n");return console.log("Kimi编辑器读取到的文本:",n),n}const t=this.element.textContent||"";if(!t.trim()&&this.element.innerHTML){const t=document.createElement("div");return t.innerHTML=this.element.innerHTML,t.textContent||""}return t}catch(t){return console.warn("获取contenteditable文本失败:",t),""}}setTextareaValue(t){try{const e=this.element,n=e.selectionStart;e.value=t;const i=Math.min(t.length,n+t.length);e.setSelectionRange(i,i)}catch(t){console.warn("设置textarea值失败:",t)}}setContentEditableText(t){try{this.element.innerHTML="",this.isKimiEditor()?this.setKimiEditorText(t):this.element.textContent=t}catch(e){console.warn("设置contenteditable文本失败:",e);try{this.element.textContent=t}catch(t){console.error("设置文本的降级处理也失败:",t)}}}isKimiEditor(){return this.element.classList.contains("chat-input-editor")||this.element.hasAttribute("data-lexical-editor")}setKimiEditorText(t){try{console.log("设置Kimi编辑器文本:",t),this.element.innerHTML="";const e=document.createElement("p");if(e.setAttribute("dir","ltr"),t.split("\n").forEach((t,n)=>{if(n>0&&e.appendChild(document.createElement("br")),t.trim()){const n=document.createElement("span");n.setAttribute("data-lexical-text","true"),n.textContent=t,e.appendChild(n)}}),0===e.children.length){const n=document.createElement("span");n.setAttribute("data-lexical-text","true"),n.textContent=t||"",e.appendChild(n)}this.element.appendChild(e),console.log("Kimi编辑器DOM结构已创建:",this.element.innerHTML),this.triggerInput(),setTimeout(()=>{try{this.triggerLexicalEvents(),this.setCursorToEnd(),this.triggerFrameworkEvents(),console.log("Kimi编辑器事件已触发")}catch(t){console.warn("Kimi编辑器延迟事件触发失败:",t)}},100),setTimeout(()=>{try{["input","change","blur","focus"].forEach(t=>{const e=new Event(t,{bubbles:!0});this.element.dispatchEvent(e)}),console.log("Kimi编辑器二次事件触发完成")}catch(t){console.warn("Kimi编辑器二次事件触发失败:",t)}},300)}catch(e){console.warn("设置Kimi编辑器文本失败，使用降级方法:",e),this.element.textContent=t,this.triggerInput()}}setCursorToEnd(){try{const t=document.createRange();t.selectNodeContents(this.element),t.collapse(!1);const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(t))}catch(t){console.warn("设置光标位置失败:",t)}}triggerFrameworkEvents(){try{this.triggerReactEvent(),this.triggerVueEvent(),this.triggerCustomEvents()}catch(t){console.warn("触发框架事件失败:",t)}}triggerReactEvent(){var t,e;if(Object.keys(this.element).filter(t=>t.startsWith("__reactInternalInstance")||t.startsWith("__reactFiber")).length>0&&((null===(t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===t?void 0:t.set)||(null===(e=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))||void 0===e?void 0:e.set))){const t=new Event("input",{bubbles:!0});t.simulated=!0,this.element.dispatchEvent(t)}}triggerVueEvent(){if(this.element.__vue__){const t=new CustomEvent("input",{bubbles:!0,detail:{value:this.getInputText()}});this.element.dispatchEvent(t)}}triggerCustomEvents(){["textchange","valuechange","contentchange"].forEach(t=>{try{const e=new CustomEvent(t,{bubbles:!0,detail:{value:this.getInputText(),target:this.element}});this.element.dispatchEvent(e)}catch(t){}})}isEditable(){try{if("textarea"===this.inputType){const t=this.element;return!t.disabled&&!t.readOnly}return"true"===this.element.contentEditable}catch(t){return!1}}getMaxLength(){try{if("textarea"===this.inputType){const t=this.element.maxLength;return t>0?t:null}return null}catch(t){return null}}isTextTooLong(t){const e=this.getMaxLength();return null!==e&&t.length>e}triggerReactFiberUpdate(){try{const t=Object.keys(this.element).find(t=>t.startsWith("__reactFiber")||t.startsWith("__reactInternalInstance"));if(t){const e=this.element[t];if(e&&e.memoizedProps){const t=e.memoizedProps.onChange;if("function"==typeof t)try{t({target:this.element,currentTarget:this.element,type:"change",nativeEvent:new Event("change"),preventDefault:()=>{},stopPropagation:()=>{}})}catch(t){console.warn("React onChange触发失败:",t)}const n=e.memoizedProps.onInput;if("function"==typeof n)try{n({target:this.element,currentTarget:this.element,type:"input",nativeEvent:new Event("input"),preventDefault:()=>{},stopPropagation:()=>{}})}catch(t){console.warn("React onInput触发失败:",t)}}}}catch(t){console.warn("触发React Fiber更新失败:",t)}}getCursorPosition(){try{if("textarea"===this.inputType)return this.element.selectionStart||0;{const t=window.getSelection();if(t&&t.rangeCount>0)return t.getRangeAt(0).startOffset}}catch(t){console.warn("获取光标位置失败:",t)}return 0}triggerLexicalEvents(){try{[{type:"input",bubbles:!0},{type:"change",bubbles:!0},{type:"keyup",bubbles:!0},{type:"textInput",bubbles:!0},{type:"lexical-update",bubbles:!0,custom:!0},{type:"lexical-change",bubbles:!0,custom:!0},{type:"editor-update",bubbles:!0,custom:!0}].forEach(t=>{try{let e;e=t.custom?new CustomEvent(t.type,{bubbles:t.bubbles,detail:{editorState:this.getInputText(),target:this.element,timestamp:Date.now()}}):"input"===t.type?new InputEvent(t.type,{bubbles:t.bubbles,cancelable:!0,inputType:"insertText",data:this.getInputText()}):new Event(t.type,{bubbles:t.bubbles}),this.element.dispatchEvent(e)}catch(e){console.warn(`触发${t.type}事件失败:`,e)}}),this.triggerReactFiberUpdate(),setTimeout(()=>{try{this.triggerInput()}catch(t){console.warn("延迟触发事件失败:",t)}},100)}catch(t){console.warn("触发Lexical事件失败:",t);try{this.triggerInput()}catch(t){console.error("Lexical事件的降级处理也失败:",t)}}}}class o{constructor(t){this.button=null,this.inputHandler=null,this.isInjected=!1,this.siteConfig=t}async inject(){try{if(this.isInjected&&this.button&&this.button.parentElement)return console.log("按钮已注入，跳过"),!0;const t=await i.waitForElement(this.siteConfig.buttonContainerSelector);if(!t)return console.warn("未找到按钮容器"),!1;const e=await i.waitForElement(this.siteConfig.inputSelector);return e?(this.inputHandler=new s(e,this.siteConfig.inputType),this.button=this.createEnhanceButton(),this.injectButton(t),this.isInjected=!0,console.log("增强按钮注入成功"),!0):(console.warn("未找到输入元素"),!1)}catch(t){return console.error("按钮注入失败:",t),!1}}async reinject(){return this.cleanup(),this.inject()}createEnhanceButton(){const t=document.createElement("div");return t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.className=this.getButtonClasses(),t.innerHTML=this.getButtonContent(),t.title="使用方法论增强提示词",t.setAttribute("data-testid","prompt-enhancer-button"),t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.handleEnhanceClick()}),t.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),this.handleEnhanceClick())}),t}getButtonClasses(){return["prompt-enhancer-button",...i.getButtonStyleClasses(this.siteConfig.type)].join(" ")}getButtonContent(){const e=i.getEnhanceIcon(this.siteConfig.type);switch(this.siteConfig.type){case t.DEEPSEEK:return`\n          <div class="ds-button__icon">\n            <span style="transition: none; transform: rotate(0deg);">\n              <div class="ds-icon" style="font-size: 17px; width: 17px; height: 17px;">\n                ${e}\n              </div>\n            </span>\n          </div>\n          <span class="ad0c98fd">P增强</span>\n        `;case t.KIMI:return`\n          ${e}\n          <span>P增强</span>\n        `;case t.DOUBAO:return`\n          <span class="semi-button-content">\n            <span role="img" class="semi-icon semi-icon-default">\n              ${e}\n            </span>\n            <span class="semi-button-content-right">\n              <div class="flex items-center">P增强</div>\n            </span>\n          </span>\n        `;default:return`${e} P增强`}}injectButton(e){if(this.button)switch(this.siteConfig.type){case t.DEEPSEEK:this.injectForDeepSeek(e);break;case t.KIMI:this.injectForKimi(e);break;case t.DOUBAO:this.injectForDoubao(e);break;default:e.appendChild(this.button)}}injectForDeepSeek(t){var e;if(!this.button)return;this.button.style.cssText="\n      --ds-button-color: #fff;\n      --button-text-color: #4c4c4c;\n      --button-border-color: rgba(0, 0, 0, 0.12);\n      --ds-button-hover-color: #E0E4ED;\n      margin-right: 8px;\n      cursor: pointer;\n    ";const n=Array.from(t.querySelectorAll(".ds-button"));let i=null;for(const t of n)if("联网搜索"===(null===(e=t.textContent)||void 0===e?void 0:e.trim())){i=t;break}i?i.insertAdjacentElement("afterend",this.button):t.appendChild(this.button)}injectForKimi(t){if(!this.button)return;const e=document.createElement("div");e.className="researcher-switch-container",e.style.cssText="\n      display: flex;\n      align-items: center;\n      margin-right: 8px;\n    ",this.button.className="deep-research-switch",this.button.style.cssText="\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 8px 12px;\n      background: rgba(0, 0, 0, 0.05);\n      border: none;\n      border-radius: 16px;\n      color: #666;\n      font-size: 14px;\n      cursor: pointer;\n      transition: background-color 0.2s ease, color 0.2s ease;\n      white-space: nowrap;\n    ",this.button.addEventListener("mouseenter",()=>{this.button.style.backgroundColor="rgba(0, 0, 0, 0.08)",this.button.style.color="#333"}),this.button.addEventListener("mouseleave",()=>{this.button.style.backgroundColor="rgba(0, 0, 0, 0.05)",this.button.style.color="#666"}),e.appendChild(this.button),t.appendChild(e)}injectForDoubao(t){if(!this.button)return;const e=t.querySelector('[data-testid="deep_think_select_button"]');e&&e.parentElement?e.parentElement.insertBefore(this.button,e.nextSibling):t.appendChild(this.button),this.button.style.cssText+="\n      flex-shrink: 0;\n      margin-left: 8px;\n      margin-right: 8px;\n    "}async handleEnhanceClick(){if(this.inputHandler)try{const t=this.inputHandler.getInputText();if(!t||0===t.trim().length)return void this.showTooltip("请先输入内容");this.setButtonState(e.LOADING);const n=await this.sendEnhanceRequest(t);if(!n.success||!n.enhancedText)throw new Error(n.error||"增强失败");this.inputHandler.setInputText(n.enhancedText),this.inputHandler.focus(),this.setButtonState(e.SUCCESS),setTimeout(()=>{this.setButtonState(e.NORMAL)},2e3)}catch(t){console.error("增强处理失败:",t),this.setButtonState(e.ERROR),this.showTooltip(t.message||"增强失败，请重试"),setTimeout(()=>{this.setButtonState(e.NORMAL)},3e3)}else console.error("输入处理器未初始化")}async sendEnhanceRequest(t){return new Promise(e=>{chrome.runtime.sendMessage({type:"ENHANCE_REQUEST",data:{userInput:t,siteType:this.siteConfig.type}},t=>{chrome.runtime.lastError?e({success:!1,error:chrome.runtime.lastError.message}):e(t.data||t)})})}setButtonState(t){if(this.button)switch(this.button.classList.remove("pe-loading","pe-success","pe-error"),t){case e.LOADING:this.button.classList.add("pe-loading"),this.button.disabled=!0,this.updateButtonContent("增强中...");break;case e.SUCCESS:this.button.classList.add("pe-success"),this.button.disabled=!1,this.updateButtonContent("✓ 已增强");break;case e.ERROR:this.button.classList.add("pe-error"),this.button.disabled=!1,this.updateButtonContent("× 失败");break;default:this.button.disabled=!1,this.button.innerHTML=this.getButtonContent()}}updateButtonContent(e){if(!this.button)return;const n=i.getEnhanceIcon(this.siteConfig.type);switch(this.siteConfig.type){case t.DEEPSEEK:this.button.innerHTML=`\n          <div class="ds-button__icon">\n            <span style="transition: none; transform: rotate(0deg);">\n              <div class="ds-icon" style="font-size: 17px; width: 17px; height: 17px;">\n                ${n}\n              </div>\n            </span>\n          </div>\n          <span class="ad0c98fd">${e}</span>\n        `;break;case t.KIMI:this.button.innerHTML=`\n          ${n}\n          <span>${e}</span>\n        `;break;case t.DOUBAO:this.button.innerHTML=`\n          <span class="semi-button-content">\n            <span role="img" class="semi-icon semi-icon-default">\n              ${n}\n            </span>\n            <span class="semi-button-content-right">\n              <div class="flex items-center">${e}</div>\n            </span>\n          </span>\n        `;break;default:this.button.innerHTML=`${n} ${e}`}}showTooltip(t){if(!this.button)return;const e=document.createElement("div");e.className="pe-tooltip",e.textContent=t,e.style.cssText="\n      position: absolute;\n      top: -40px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(0, 0, 0, 0.8);\n      color: white;\n      padding: 6px 12px;\n      border-radius: 4px;\n      font-size: 12px;\n      white-space: nowrap;\n      z-index: 10000;\n      pointer-events: none;\n    ",this.button.style.position="relative",this.button.appendChild(e),setTimeout(()=>{e.remove()},3e3)}cleanup(){this.button&&this.button.parentElement&&this.button.remove(),this.button=null,this.inputHandler=null,this.isInjected=!1}isButtonInjected(){return!!(this.isInjected&&this.button&&this.button.parentElement)}getButton(){return this.button}}let r=null;r||(r=new class{constructor(){this.buttonInjector=null,this.isInitialized=!1,this.buttonCheckTimer=null,this.siteType=i.detectSite(),this.init()}async init(){try{if(!i.isSupportedSite(this.siteType))return void console.log("当前网站不受提示词增强器支持");if(!i.isChatPage())return console.log("当前页面不是聊天页面，等待跳转..."),void this.setupPageChangeListener();console.log(`提示词增强器已加载，网站类型: ${this.siteType}`),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.initializeEnhancer()):this.initializeEnhancer()}catch(t){console.error("内容脚本初始化失败:",t)}}async initializeEnhancer(){if(!this.isInitialized)try{const t=i.getSiteConfig(this.siteType);console.log("等待页面元素加载...");const[e,n]=await i.waitForElements([t.inputSelector,t.buttonContainerSelector]);if(!e||!n)return console.warn("未找到必要的页面元素，将在页面变化时重试"),void this.setupRetryMechanism();this.buttonInjector=new o(t),await this.buttonInjector.inject(),this.isInitialized=!0,console.log("提示词增强器初始化完成"),this.setupMutationObserver()}catch(t){console.error("增强器初始化失败:",t),this.setupRetryMechanism()}}setupPageChangeListener(){let t=window.location.href;const e=()=>{window.location.href!==t&&(t=window.location.href,i.isChatPage()&&(console.log("检测到跳转到聊天页面，开始初始化..."),this.isInitialized=!1,setTimeout(()=>this.initializeEnhancer(),1e3)))};setInterval(e,1e3),window.addEventListener("popstate",e);const n=history.pushState,s=history.replaceState;history.pushState=function(...t){n.apply(history,t),setTimeout(e,100)},history.replaceState=function(...t){s.apply(history,t),setTimeout(e,100)}}setupMutationObserver(){new MutationObserver(e=>{let n=!1,i=!1;for(const s of e)"childList"===s.type&&(s.removedNodes.forEach(e=>{var s,o,r,a;if(e.nodeType===Node.ELEMENT_NODE){const c=e;((null===(s=c.querySelector)||void 0===s?void 0:s.call(c,".prompt-enhancer-button"))||(null===(o=c.classList)||void 0===o?void 0:o.contains("prompt-enhancer-button")))&&(n=!0),this.siteType===t.KIMI&&((null===(r=c.classList)||void 0===r?void 0:r.contains("left-area"))||(null===(a=c.querySelector)||void 0===a?void 0:a.call(c,".left-area")))&&(i=!0)}}),s.addedNodes.forEach(e=>{var n,s;if(e.nodeType===Node.ELEMENT_NODE){const o=e;this.siteType===t.KIMI&&((null===(n=o.classList)||void 0===n?void 0:n.contains("left-area"))||(null===(s=o.querySelector)||void 0===s?void 0:s.call(o,".left-area")))&&(i=!0)}}));(n||i)&&this.buttonInjector&&(console.log("检测到按钮被移除或结构变化，重新注入..."),setTimeout(()=>{var t;null===(t=this.buttonInjector)||void 0===t||t.reinject()},500)),this.scheduleButtonCheck()}).observe(document.body,{childList:!0,subtree:!0}),this.scheduleButtonCheck()}scheduleButtonCheck(){this.buttonCheckTimer&&clearTimeout(this.buttonCheckTimer),this.buttonCheckTimer=window.setTimeout(()=>{this.buttonInjector&&this.isInitialized&&(this.buttonInjector.isButtonInjected()||(console.log("定期检查：按钮丢失，重新注入..."),this.buttonInjector.reinject())),this.scheduleButtonCheck()},1e4)}setupRetryMechanism(){let t=0;const e=()=>{t>=5?console.warn("达到最大重试次数，停止重试"):(t++,console.log(`第 ${t} 次重试初始化...`),setTimeout(()=>{this.isInitialized||this.initializeEnhancer().catch(()=>{e()})},2e3*t))};e()}cleanup(){this.buttonCheckTimer&&(clearTimeout(this.buttonCheckTimer),this.buttonCheckTimer=null),this.buttonInjector&&(this.buttonInjector.cleanup(),this.buttonInjector=null),this.isInitialized=!1}}),window.addEventListener("beforeunload",()=>{r&&(r.cleanup(),r=null)}),window.promptEnhancer={contentScript:r,siteType:i.detectSite(),isSupported:i.isSupportedSite(),isChatPage:i.isChatPage()}})();